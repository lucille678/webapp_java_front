<div [class]="templateName + '-template'" class="portfolio-preview" style="min-height: 100vh; width: 100%;">
  <!-- Navbar fixe -->
  <nav class="portfolio-nav" [class.scrolled]="isScrolled">
    <div class="nav-content">
      <h1 class="nav-title">Mon Portfolio</h1>
      <button class="mobile-menu-btn" (click)="toggleMobileMenu()">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <ul class="nav-links" [class.mobile-open]="mobileMenuOpen">
        <li *ngFor="let section of sections"
            [class.active]="activeSection === section.id"
            (click)="scrollToSection(section.id)">
          {{ section.label }}
        </li>
      </ul>
      <div class="nav-actions">
        <button class="edit-btn" (click)="goBackToEdit()">Modifier</button>
        <button class="publish-btn" (click)="publish()">Publier</button>
      </div>
    </div>
  </nav>

  <!-- Contenu du portfolio -->
  <div class="portfolio-content">
    <!-- Section Accueil -->
    <header id="accueil">
      <div class="header-content" *ngIf="data?.accueil">
        <img *ngIf="data?.accueil?.photo?.content" 
             [src]="data?.accueil?.photo?.content" 
             alt="Photo de profil">
        <h1>{{ data?.accueil?.firstName }} {{ data?.accueil?.lastName }}</h1>
        <p>{{ data?.accueil?.objective }}</p>
        <p class="bio">{{ data?.accueil?.bio }}</p>
        <p class="location" *ngIf="data?.accueil?.locations">
          {{ data?.accueil?.locations }}
        </p>
      </div>
    </header>

    <!-- Section Formations -->
    <section id="formations" *ngIf="data?.formation?.length">
      <h2>Formations</h2>
      <div class="formations-container">
        <div class="formation-item" *ngFor="let formation of data.formation">
          <h3>{{ formation.degree }}</h3>
          <p class="school">{{ formation.school }}</p>
          <p class="date">{{ formatDateRange(formation.startDate, formation.endDate, formation.current) }}</p>
          <p class="description">{{ formation.description }}</p>
        </div>
      </div>
    </section>

    <!-- Section Expériences -->
    <section id="experiences" *ngIf="data?.experience?.length">
      <h2>Expériences</h2>
      <div class="experiences-container">
        <div class="experience-item" *ngFor="let exp of data.experience">
          <h3>{{ exp.jobTitle }}</h3>
          <h4>{{ exp.company }}</h4>
          <p class="date">{{ formatDateRange(exp.startDate, exp.endDate, exp.current) }}</p>
          <p class="description">{{ exp.description }}</p>
        </div>
      </div>
    </section>

    <!-- Section Compétences -->
    <section id="competences" *ngIf="data?.competences">
      <h2>Compétences</h2>
      <div class="competences-container">
        <div class="competence-card" *ngIf="data?.competences?.softSkills">
          <h3>Soft Skills</h3>
          <p>{{ data?.competences?.softSkills }}</p>
        </div>
        <div class="competence-card" *ngIf="data?.competences?.hardSkills">
          <h3>Hard Skills</h3>
          <p>{{ data?.competences?.hardSkills }}</p>
        </div>
        <div class="competence-card" *ngIf="data?.competences?.languages">
          <h3>Langues</h3>
          <p>{{ data?.competences?.languages }}</p>
        </div>

        <!-- Certificats -->
        <div class="competence-card certificates" *ngIf="data?.competences?.certificates?.length">
          <h3>Certifications</h3>
          <div class="certificates-container">
            <div class="certificate-item" *ngFor="let cert of data?.competences?.certificates || []">
              <span>{{ cert?.name }}</span>
              <a *ngIf="cert?.file?.content"
                 [href]="cert?.file?.content"
                 target="_blank"
                 class="certificate-link">
                Voir le certificat
              </a>
            </div>
          </div>
        </div>

        <!-- Catégories personnalisées -->
        <div class="competence-card" *ngFor="let category of data?.competences?.customCategories || []">
          <h3>{{ category?.name }}</h3>
          <p>{{ category?.content }}</p>
        </div>
      </div>
    </section>

    <!-- Sections personnalisées -->
    <ng-container *ngFor="let section of customSections">
      <section [id]="section.name" *ngIf="getSectionData(section.name)">
        <h2>{{ section.label }}</h2>
        <div [class]="section.name + '-container'">
          <div [class]="section.name + '-content'">
            <ng-container *ngFor="let field of section.fields">
              <div [ngSwitch]="field.type">
                <p *ngSwitchCase="'text'">{{ getSectionFieldData(section.name, field.name) }}</p>
                <p *ngSwitchCase="'textarea'">{{ getSectionFieldData(section.name, field.name) }}</p>
                <img *ngSwitchCase="'file'" 
                     [src]="getSectionFieldData(section.name, field.name)?.content" 
                     [alt]="field.label">
                <p *ngSwitchCase="'date'" class="date">
                  {{ formatDateRange(
                       getSectionFieldData(section.name, 'startDate'),
                       getSectionFieldData(section.name, 'endDate'),
                       getSectionFieldData(section.name, 'current')
                     ) }}
                </p>
              </div>
            </ng-container>
          </div>
        </div>
      </section>
    </ng-container>
  </div>
</div>
